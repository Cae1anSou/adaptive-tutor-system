<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Element selection and knowledge point display</title>
    <script src="../js/modules/cytoscape.min.js"></script>
    <link rel="stylesheet" href="../css/styles.css">
    <!-- Iconify图标库 -->
  <script src="../js/modules/iconify-icon.min.js"></script>
</head>
<body>
    <div class="main-container">
      <!-- 顶部标题栏 -->
        <header class="top-header-lean">
            <h1 class="header-title" id="headerTitle">
              <iconify-icon icon="mdi:book-education" width="24" height="24"></iconify-icon>
              loading...
            </h1>
            <!-- 中英文切换按钮 -->
            <button id="language-toggle" class="back-button" style="position: absolute; right: 120px; display: flex; align-items: center; gap: var(--spacing-xs); padding: var(--spacing-sm) var(--spacing-md); background-color: rgba(255, 255, 255, 0.2); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: var(--border-radius-md); color: white; cursor: pointer; transition: all 0.2s ease; font-size: var(--font-size-sm); font-weight: 500;">
              <iconify-icon icon="mdi:translate" width="20" height="20"></iconify-icon>
              EN
            </button>
            <!-- 简化的知识图谱预览 -->
             <div class="mini-knowledge-graph" id="miniKnowledgeGraph">
              <div class="mini-graph-toggle" id="miniGraphToggle">
                <iconify-icon icon="mdi:chevron-down" width="20" height="20" id="toggleIcon"></iconify-icon>
              </div>
              <div class="mini-graph-container" id="miniGraphContainer"></div>
            </div>
            <div class="user-profile">
              <button class="back-button" id="backButton">
                <iconify-icon icon="mdi:arrow-left" width="20" height="20"></iconify-icon>
                return
              </button>
              <iconify-icon icon="mdi:account-circle" width="36" height="36"></iconify-icon>
            </div>
        </header>
        
        <!-- 知识图谱容器 -->
        <div id="knowledge-graph-container" class="knowledge-graph-container" style="display: none;">
          <div class="index-container panel">
            <div class="panel-header">
              <iconify-icon icon="mdi:progress-check" width="20" height="20"></iconify-icon>
              <h2>Knowledge Graph</h2>
              <button id="closeGraph" title="关闭">
                <iconify-icon icon="mdi:close" width="20" height="20"></iconify-icon>
              </button>
            </div>
            <div class="group" id="cy">
              <!-- 工具栏 -->
              <div class="cy-toolbar">
                <button id="zoomIn" title="放大" class="btn btn-small">
                  <iconify-icon icon="mdi:magnify-plus" width="16" height="16"></iconify-icon>
                </button>
                <button id="zoomOut" title="缩小" class="btn btn-small">
                  <iconify-icon icon="mdi:magnify-minus" width="16" height="16"></iconify-icon>
                </button>
                <button id="centerGraph" title="居中" class="btn btn-small">
                  <iconify-icon icon="mdi:select-search" width="16" height="16"></iconify-icon>
                  居中
                </button>
              </div>
              
              <!-- 提示信息 -->
              <div class="cy-tip">
                <iconify-icon icon="mdi:information" width="16" height="16"></iconify-icon>
                <span>Tip: Click a node to expand/collapse it, double-click a node to view details</span>
              </div>
            </div>
          </div>
        </div>
        
        <div class="content-container">
          <!-- 左侧组合列（占 60% 宽） -->
          <div class="left-group">
            <!-- 上排：开放式示例页面探索（预览 + 代码展示） -->
            <div class="top-row">
              <!-- 整合的示例页面探索区域 -->
              <div class="example-exploration-panel panel">
                <!-- 统一标题栏 -->
                <div class="panel-header">
                  <iconify-icon icon="mdi:web" width="18" height="18"></iconify-icon>
                  <h2>Open-ended Exploration</h2>
                </div>
                <!-- 内容区域：左侧预览 + 右侧代码 -->
                <div class="exploration-content">
                  <!-- 左侧网页预览区 -->
                  <div class="preview-section">
                      <div class="ratio-16x9">
                        <iframe
                          id="element-selector-iframe"
                          src="example_pages/index.html"
                        ></iframe>
                      </div>
                  </div>
                  <!-- 右侧代码展示区 -->
                  <div class="code-section">
                    <div class="info-content" id="code-content">
                        <h2>Selected element code</h2>
                        <pre id="selectedElementCode"></pre>
                    </div>
                    <!-- 代码展示面板底部的选择器控制区域 -->
                    <div class="code-panel-footer">
                        <div class="selector-controls">
                            <button id="startSelector" class="btn btn-select">
                              <iconify-icon icon="mdi:cursor-default-click" width="16" height="16"></iconify-icon>
                              Select elements
                            </button>
                            <button id="stopSelector" class="btn btn-select btn-stop-selector" style="display: none;">
                              <iconify-icon icon="mdi:stop" width="16" height="16"></iconify-icon>
                              Stop Selection
                            </button>
                            <button id="askAIButton" class="btn btn-ai" style="display: none;">
                              <iconify-icon icon="mdi:robot-happy" width="16" height="16"></iconify-icon>
                              Ask the AI
                            </button>
                            <button id="clearSelectionButton" class="btn btn-clear" style="display: none;">
                              <iconify-icon icon="mdi:close" width="16" height="16"></iconify-icon>
                              Clear Selection
                            </button>
                        </div>
                        <!-- 选择范围开关 -->
                        <div class="selector-toggle-container">
                            <label class="toggle-label">
                                <input type="checkbox" id="cumulativeToggle">
                                <span>Contains elements from previous chapters</span>
                            </label>
                            <div class="toggle-description">
                              <iconify-icon icon="mdi:information" width="14" height="14"></iconify-icon>
                                When turned on, you can select elements of the current and all previous chapters. When turned off, you can only select elements of the current chapter.
                            </div>
                        </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- 下排：知识点（跨左+中列） -->
            <div class="knowledge-panel panel" id="knowledge-panel">
                <div class="panel-header">
                  <iconify-icon icon="mdi:lightbulb-on" width="18" height="18"></iconify-icon>
                  <h2>Progressive Knowledge Unfolding</h2>
                </div>
                <div class="info-content" id="knowledge-content">
                    <div class="levels-container">
                        <div class="levels-flow">
                            <div class="level-card collapsed" data-level="1">
                                <div class="level-header">
                                  <h3>Level 1 · Base</h3>
                                  <p class="level-description">Suitable for beginners with zero foundation, mastering core concepts and basic grammar.</p>
                                </div>
                                <div class="level-content">
                                  <p class="content-text">The knowledge point content will be dynamically loaded by JavaScript...</p>
                                </div>
                                <div class="click-hint">
                                  <iconify-icon icon="mdi:mouse" width="14" height="14"></iconify-icon>
                                  Click to enter the study
                                </div>
                            </div>
                            <div class="arrow" aria-hidden="true">
                              <iconify-icon icon="mdi:arrow-right" width="32" height="32"></iconify-icon>
                            </div>
                            <div class="level-card collapsed" data-level="2">
                                <div class="level-header">
                                  <h3>Level 2 · medium</h3>
                                  <p class="level-description">Understand common scenarios and combined usage to improve practical skills.</p>
                                </div>
                                <div class="level-content">
                                  <p class="content-text">The knowledge point content will be dynamically loaded by JavaScript...</p>
                                </div>
                                <div class="click-hint">
                                  <iconify-icon icon="mdi:mouse" width="14" height="14"></iconify-icon>
                                  Click to enter the study
                                </div>
                            </div>
                            <div class="arrow" aria-hidden="true">
                              <iconify-icon icon="mdi:arrow-right" width="32" height="32"></iconify-icon>
                            </div>
                            <div class="level-card collapsed" data-level="3">
                                <div class="level-header">
                                  <h3>Level 3 · Advanced</h3>
                                  <p class="level-description">Deepen mechanism and performance optimization to form systematic cognition.</p>
                                </div>
                                <div class="level-content">
                                  <p class="content-text">The knowledge point content will be dynamically loaded by JavaScript...</p>
                                </div>
                                <div class="click-hint">
                                  <iconify-icon icon="mdi:mouse" width="14" height="14"></iconify-icon>
                                  Click to enter the study
                                </div>
                            </div>
                            <div class="arrow" aria-hidden="true">
                              <iconify-icon icon="mdi:arrow-right" width="32" height="32"></iconify-icon>
                            </div>
                            <div class="level-card collapsed" data-level="4">
                                <div class="level-header">
                                    <h3>Level 4 · Challenge</h3>
                                    <p class="level-description">Comprehensive practical and extension questions to test and break through the current level.</p>
                                </div>
                                <div class="level-content">
                                  <p class="content-text">The knowledge point content will be dynamically loaded by JavaScript...</p>
                                </div>
                                <div class="click-hint">
                                  <iconify-icon icon="mdi:mouse" width="14" height="14"></iconify-icon>
                                  Click to enter the study
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <button id="start-test-button" class="btn btn-primary start-button">
                  <iconify-icon icon="mdi:play" width="18" height="18"></iconify-icon>
                  Start practicing
                </button>
            </div>
          </div>

          <!-- 右侧 AI 对话（占 40% 宽，跨两行） -->
          <div class="chat-panel panel">
            <div class="panel-header">
              <iconify-icon icon="mdi:robot" width="18" height="18"></iconify-icon>
              <h2>Al Teaching Assistant Module</h2>
            </div>
            <div class="chat-history">
              <div class="ai-chat-messages" id="ai-chat-messages">
                <div class="user-message">
                  <div class="user-avatar">
                    <iconify-icon icon="mdi:account" width="20" height="20"></iconify-icon>
                  </div>
                  <div class="user-content">
                        我想学习html的表格，请给我介绍一下，和外界html初学者
                  </div>
                </div>
                <div class="ai-message">
                  <div class="ai-avatar">
                    <iconify-icon icon="mdi:robot" width="20" height="20"></iconify-icon>
                  </div>
                  <div class="ai-content">
                    <div class="markdown-content">
                            当然可以！作为 HTML 初学者，学习"表格（Table）"是非常实用的一步。它能帮助你做网页中最常见的数据结构，比如成绩单、产品价格表等。<br><br><b>HTML 表格的基本结构</b><br>HTML 使用 <code>&lt;table&gt;</code> 标签来创建表格，基本结构如下：<br>
                            <pre class="code-example">&lt;table&gt;
                                &lt;tr&gt;
                                  &lt;th&gt;标题1&lt;/th&gt;
                                  &lt;th&gt;标题2&lt;/th&gt;
                                &lt;/tr&gt;
                                &lt;tr&gt;
                                  &lt;td&gt;单元格1&lt;/td&gt;
                                  &lt;td&gt;单元格2&lt;/td&gt;
                                &lt;/tr&gt;
                            &lt;/table&gt;</pre>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="ai-chat-input">
              <!-- 聊天输入主区域 -->
              <div class="chat-input-main">
                <textarea id="user-message" placeholder="请输入信息"></textarea>
                <button type="button" id="send-message" class="btn btn-primary">
                  <iconify-icon icon="mdi:send" width="16" height="16"></iconify-icon>
                  Send message
                </button>
              </div>
            </div>
            <div class="status-container">
              <span id="statusBadge"></span>
            </div>
            <div class="status-container">
            </div>
          </div>
        </div>
    </div>

    <!-- 知识点详情弹窗 -->
    <div id="knowledgeModal" class="modal">
      <div class="modal-content">
        <iconify-icon icon="mdi:book-open" width="32" height="32" style="color: var(--primary-color);"></iconify-icon>
        <h2 id="modalTitle"></h2>
        <p id="modalStatus"></p>
        <div class="modal-actions">
          <button id="learnBtn" class="btn btn-primary">学习</button>
          <button id="testBtn" class="btn btn-primary">测试</button>
        </div>
      </div>
    </div>

  <!-- 引入learning_page.js（已包含所有必要功能） -->
  <script type="module" src="../js/pages/learning_page.js"></script>

</body>
</html>